!contents -R2 -g -p -f -h
| import |
| epc.therest.fitnesse |

!1 Duplicate user supplied id
A user should not be able to create a post with an id that already exists. This check is only applicable for record types that has userSuppliedId=true.

!***> Create a metadataGroup(car)

!| RecordEndpointFixture |
| type | json | testCreateRecord? | getStatusType? |
| metadataGroup | {"name":"metadata","attributes":{"type":"group"},"children":[{"name":"recordInfo","children":[{"id":"carNew"}]},{"textId":"carText"},{"defTextId":"carDefText"},{"nameInData":"car"},{"name":"childReferences","children":[{"name":"childReference","children":[{"ref":"recordInfoNew"},{"repeatMin":"1"},{"repeatMax":"1"}]},{"name":"childReference","children":[{"ref":"id"},{"repeatMin":"1"},{"repeatMax":"1"}]}]}]} | {"record":{"data":{"children":[{"children":[{"id":"carNew"},{"type":"metadataGroup"},{"createdBy":"userId"}],"name":"recordInfo"},{"textId":"carText"},{"defTextId":"carDefText"},{"nameInData":"car"},{"children":[{"children":[{"ref":"recordInfoNew"},{"repeatMin":"1"},{"repeatMax":"1"}],"name":"childReference"},{"children":[{"ref":"id"},{"repeatMin":"1"},{"repeatMax":"1"}],"name":"childReference"}],"name":"childReferences"}],"name":"metadata","attributes":{"type":"group"}},"actionLinks":{"read":{"requestMethod":"GET","rel":"read","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/metadataGroup/carNew","accept":"application/uub+record+json"},"update":{"requestMethod":"POST","rel":"update","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/metadataGroup/carNew","accept":"application/uub+record+json"},"delete":{"requestMethod":"DELETE","rel":"delete","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/metadataGroup/carNew","accept":"application/uub+record+json"}}}} | CREATED |
| metadataGroup | {"name":"metadata","attributes":{"type":"group"},"children":[{"name":"recordInfo","children":[{"id":"car"}]},{"textId":"carText"},{"defTextId":"carDefText"},{"nameInData":"car"},{"name":"childReferences","children":[{"name":"childReference","children":[{"ref":"recordInfo"},{"repeatMin":"1"},{"repeatMax":"1"}]},{"name":"childReference","children":[{"ref":"id"},{"repeatMin":"1"},{"repeatMax":"1"}]}]}]} | {"record":{"data":{"children":[{"children":[{"id":"car"},{"type":"metadataGroup"},{"createdBy":"userId"}],"name":"recordInfo"},{"textId":"carText"},{"defTextId":"carDefText"},{"nameInData":"car"},{"children":[{"children":[{"ref":"recordInfo"},{"repeatMin":"1"},{"repeatMax":"1"}],"name":"childReference"},{"children":[{"ref":"id"},{"repeatMin":"1"},{"repeatMax":"1"}],"name":"childReference"}],"name":"childReferences"}],"name":"metadata","attributes":{"type":"group"}},"actionLinks":{"read":{"requestMethod":"GET","rel":"read","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/metadataGroup/car","accept":"application/uub+record+json"},"update":{"requestMethod":"POST","rel":"update","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/metadataGroup/car","accept":"application/uub+record+json"},"delete":{"requestMethod":"DELETE","rel":"delete","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/metadataGroup/car","accept":"application/uub+record+json"}}}} | CREATED |

*!
!***> Create a recordType(car)

!| RecordEndpointFixture |
| type | json | testCreateRecord? | getStatusType? |
| recordType | {"name":"recordType","children":[{"name":"recordInfo","children":[{"id":"car"}]},{"metadataId":"car"},{"abstract":"false"},{"presentationViewId":"pgCarView"},{"presentationFormId":"pgCarForm"},{"newMetadataId":"carNew"},{"newPresentationFormId":"pgCarForm"},{"listPresentationViewId":"pgCarList"},{"searchMetadataId":"carSearch"},{"searchPresentationFormId":"pgCarSearchForm"},{"userSuppliedId":"true"},{"selfPresentationViewId":"pgCarSelf"},{"permissionKey":"PLANT"}]} | {"record":{"data":{"children":[{"children":[{"id":"car"},{"type":"recordType"},{"createdBy":"userId"}],"name":"recordInfo"},{"metadataId":"car"},{"abstract":"false"},{"presentationViewId":"pgCarView"},{"presentationFormId":"pgCarForm"},{"newMetadataId":"carNew"},{"newPresentationFormId":"pgCarForm"},{"listPresentationViewId":"pgCarList"},{"searchMetadataId":"carSearch"},{"searchPresentationFormId":"pgCarSearchForm"},{"userSuppliedId":"true"},{"selfPresentationViewId":"pgCarSelf"},{"permissionKey":"PLANT"}],"name":"recordType"},"actionLinks":{"read":{"requestMethod":"GET","rel":"read","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/recordType/car","accept":"application/uub+record+json"},"update":{"requestMethod":"POST","rel":"update","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/recordType/car","accept":"application/uub+record+json"},"delete":{"requestMethod":"DELETE","rel":"delete","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/recordType/car","accept":"application/uub+record+json"}}}} | CREATED |

*!
!***> Create data on car

!| RecordEndpointFixture |
| type | json | testCreateRecord? | getStatusType? |
| car | {"name":"car","children":[{"name":"recordInfo","children":[{"id":"skoda"}]},{"id":"notRealyAnId"}]} | {"record":{"data":{"children":[{"children":[{"id":"skoda"},{"type":"car"},{"createdBy":"userId"}],"name":"recordInfo"},{"id":"notRealyAnId"}],"name":"car"},"actionLinks":{"read":{"requestMethod":"GET","rel":"read","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"},"update":{"requestMethod":"POST","rel":"update","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"},"delete":{"requestMethod":"DELETE","rel":"delete","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"}}}} | CREATED |

*!
!***> List data(car)

!| RecordEndpointFixture |
| type | testReadRecordList? | getStatusType? |
| car | {"recordList":{"fromNo":"0","records":[{"record":{"data":{"children":[{"children":[{"id":"skoda"},{"type":"car"},{"createdBy":"userId"}],"name":"recordInfo"},{"id":"notRealyAnId"}],"name":"car"},"actionLinks":{"read":{"requestMethod":"GET","rel":"read","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"},"update":{"requestMethod":"POST","rel":"update","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"},"delete":{"requestMethod":"DELETE","rel":"delete","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"}}}}],"totalNo":"0","toNo":"0","containRecordsOfType":"car"}} | OK |

*!
!***> Try to create data on car using the same id, this should fail as it is a duplicate

!| RecordEndpointFixture |
| type | json | testCreateRecord? | getStatusType? |
| car | {"name":"car","children":[{"name":"recordInfo","children":[{"id":"skoda"}]},{"id":"aFakeSkoda"}]} | Record with recordId: skoda already exists | CONFLICT |

*!
!***> Delete data on car

!| RecordEndpointFixture |
| type | id | testDeleteRecord? | getStatusType? |
| car | skoda | | OK |

*!
!***> Create data on car

!| RecordEndpointFixture |
| type | json | testCreateRecord? | getStatusType? |
| car | {"name":"car","children":[{"name":"recordInfo","children":[{"id":"skoda"}]},{"id":"notRealyAnId"}]} | {"record":{"data":{"children":[{"children":[{"id":"skoda"},{"type":"car"},{"createdBy":"userId"}],"name":"recordInfo"},{"id":"notRealyAnId"}],"name":"car"},"actionLinks":{"read":{"requestMethod":"GET","rel":"read","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"},"update":{"requestMethod":"POST","rel":"update","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"},"delete":{"requestMethod":"DELETE","rel":"delete","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"}}}} | CREATED |

*!
!***> Read data on car

!| RecordEndpointFixture |
| type | id | testReadRecord? | getStatusType? |
| car | skoda | {"record":{"data":{"children":[{"children":[{"id":"skoda"},{"type":"car"},{"createdBy":"userId"}],"name":"recordInfo"},{"id":"notRealyAnId"}],"name":"car"},"actionLinks":{"read":{"requestMethod":"GET","rel":"read","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"},"update":{"requestMethod":"POST","rel":"update","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"},"delete":{"requestMethod":"DELETE","rel":"delete","contentType":"application/uub+record+json","url":"http://localhost:8080/therest/rest/record/car/skoda","accept":"application/uub+record+json"}}}} | OK |

*!
